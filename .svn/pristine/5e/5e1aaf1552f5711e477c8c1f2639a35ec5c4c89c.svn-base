<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport" />
    <!--<meta http-equiv="X-UA-Compatible" content="ie=edge">-->
    <link rel="stylesheet" href="__HOME_CSS__/wh/base.css">
    <script src="__HOME_JS__/whjs/js/jquery-1.8.3.min.js"></script>
    <script src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
    <script src="__HOME_JS__/whjs/js/newrem.js"></script>
    <title>全球移动互联网大会在线报名系统</title>
    <style>
        body,html{
        background: #fff;
        padding-bottom: .64rem;
        }


        .upload{
        width: 100%;

        }

        .upload .id-card{
        width: 100%;
        height: 100%;
        padding: .22rem 0;
        padding-bottom: .3rem;
        margin-bottom: .06rem;
        background: #fff;
        border-bottom: 1px solid #EEEEEE;
        }

        .id-card .tip{
        font-size: .15rem;
        padding-left: .16rem;
        font-weight: bold;
        box-sizing: border-box;
        }

        .id-card .sma-tip{
        font-size: .12rem;
        padding-left: .16rem;
        box-sizing: border-box;
        color: #A5A5A5;
        margin-top: .05rem;
        }


        .id-card .up-box{
        width: 100%;
        height: 100%;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-around;
        }

        .id-card .up-box li{
        width: 1.6rem;
        height: 1.05rem;
        margin: .24rem 0 .14rem 0;
        }

        .up-box li .box{
        position: relative;
        width: 100%;
        height: 100%;

        }
        .up-box li p{
        text-align: center;
        margin-top: .14rem;
        }

        .up-box li .box input{
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        opacity: 0;
        z-index: 10;
        }

        .up-box li .box img{
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        }



        .Continue{
        width: 100%;
        height: .64rem;
        box-shadow:1px 2px 4px 4px rgba(242,242,242,0.5);
        position: fixed;
        bottom: 0;
        left: 0;
        background: #fff;
        }

        .Continue .con{
        position: relative;
        width: 100%;
        height: 100%;
        }

        .Continue .con button{
        width: 1.15rem;
        height: .44rem;
        line-height: .44rem;
        background: #86ADFF;
        color: #fff;
        text-align: center;
        position: absolute;
        right: .28rem;
        top: .1rem;
        border: 0;
        outline: none;
        border-radius: .04rem;
        }

        .Continue .con img{
        width: .09rem;
        height: .15rem;
        position: absolute;
        right: .5rem;
        top: .25rem;
        }


        .sbxx .tp button{
        width: 2.4rem;
        height: .4rem;
        line-height: .4rem;
        color: #fff;
        text-align: center;
        margin: 0 auto;
        background: #8CADFF;
        border: 0;
        outline: none;
        border-radius: .04rem;
        margin-top: .3rem;
        }

         .msg{
             width: 100%;
             
         }

        .msg .yz{
            font-size: .15rem;
            color: #000000;
            font-weight: bold;
            padding-top: .22rem;
            padding-left: .16rem;
            padding-bottom: .1rem;
            box-sizing: border-box;
        }

        .msg .item{
            width: 100%;
            height: .5rem;
            margin-bottom: .01rem;
            border-bottom: 1px solid #F1F1F1;
        }

          .msg .item input{
            width: 70%;
            height: 100%;
            padding-left: .16rem;
            box-sizing: border-box;
            border: 0;
            outline: none;
          }

           .msg .item button{
               width: 30%;
               height: 100%;
               border: 0 ;
               outline: none;
               color: #fff;
               background: #86ADFF;
               text-align: center;
           }

           .default{
               width: 100%;
           }

            .default .de{
                font-size: .15rem;
                font-weight: bold;
                padding: .16rem .16rem;
                
            }

            .default .choice{
                width: 100%;
                height: 100%;
                padding-left: .16rem;
                box-sizing: border-box;
            }

             .default .choice .fy{
                 width: 100%;
                 margin-right: .15rem;
                 padding: .08rem .09rem;
                 box-sizing: border-box;
                  border-bottom: 1px solid #F1F1F1;
             }

               .default .choice .fy p:nth-child(1){
                   font-size: .15rem;
                   padding-bottom: .05rem;
               }
               .default .choice .fy p:nth-child(2){
                   font-size: .12rem;
               }

               .default .xz{
                    font-size: .15rem;
                    font-weight: bold;
                    padding: .16rem .16rem;
               }

               .total{
                   width: 100%;
                   height: 100%;
                   line-height: .64rem;
                   text-indent: .16rem;
                   color: #86ADFF;
               }

               .default .zf{
                    font-size: .15rem;
                    font-weight: bold;
                    padding: .16rem .16rem;
               }

               #shuoming{
                   width:100%;
                   height: 1rem;
                   max-height: 1rem;
                   overflow:scroll;
                   padding-right: .1rem;
                   box-sizing: border-box;
               }

               #zf{
                   padding-bottom:0; 
               }
        #dx{
            width: 2.92rem;
            height: 3.12rem;
            position: fixed;
            top: 50%;
            left: 50%;
            margin-top: -1.56rem;
            margin-left: -1.46rem;
            display: none;
            z-index: 999;
            background: #fff;
            border-radius: .04rem;
        }
        #dx .dx-box{
            width: 100%;
            height: 100%;
            position: relative;
            text-align: center;
            overflow: hidden;
        }

        #dx .dx-box .ddd{
            width: 1rem;
            height: 1rem;
            position: absolute;
            top: 40%;
            left: 50%;
            margin-left: -.5rem;
            margin-top: -.5rem;
        }

        #dx .dx-box .del{
            width: .14rem;
            height: .14rem;
            position: absolute;
            right: .12rem;
            top: .12rem;
        }

        #dx .dx-box p{
            position: absolute;
            bottom: .5rem;
            width: 100%;
            text-align: center;
        }

        .mess-msg{
            width: 100%;
            height: 1.5rem;
            max-height: 1.5rem;
            overflow: scroll;
        }



        .model {
            width: 2rem;
            height: 0.5rem;
            background: rgba(0, 0, 0, 0.5);
            color: #fff;
            line-height: 0.5rem;
            font-size:0.2rem;
            border-radius: 0.122rem;
            text-align: center;
            position: absolute;
            bottom: 2rem;
            left: 22%;
            /*margin-left: 2rem;*/
        display: none;
        }

        .tips{
            padding: .1rem .16rem;
            box-sizing: border-box;
            width: 100%;
            position: relative;
        }

        .tips p{
            background: #eee;
            color: rgb(234, 53, 53);
            padding: .025rem .05rem;
            box-sizing: border-box;
        }
        
        .tips .tit{
            font-size: .18rem;
            padding:.1rem .05rem;

        }
        .tips .del{
                width: .18rem;
                height: .18rem;
                position: absolute;
                top: .18rem;
                right: .25rem;
                z-index: 999;
        }

 
    
    </style>
</head>

<body>

    <div class="tips">
        <p class="tit">温馨提示：必读</p>
        <p class="item">1.暂时港澳通行证还没办下来的可以先不上传。</p>
        <p class="item">2.请务必要记得12月9日到达深圳集合的时候要带好有效的港澳通行证。非常重要！</p>
        <p class="item">3.因为个人原因而无法出境，费用一律不予退还！</p>
        <img class="del" src="__HOME_IMAGES__/wh/make_icon_close@2x.png" alt="">
    </div>
    <div class="upload">
        <div class="id-card">
            <p class="tip">签证</p>
            <!-- <p class="sma-tip">请保证上传证件字迹清晰，边框完整，避免反光</p> -->
            <ul class="up-box">
                <li >
                    <div class="box">
                        <input  class="up-data" type="file" data-name="user_qiimgurl_just" isfalg="true" accept="image/*">
                        <img src="{$order.user_qiimgurl_just}" alt="">
                    </div>
                    <p>拍摄正面</p>
                </li>
                <li  >
                    <div class="box">
                        <input class="up-data" type="file" accept="image/*"  data-name="user_qiimgurl_fan" isfalg="true">
                        <img src="{$order.user_qiimgurl_fan}" alt="">
                    </div>
                    <p>拍摄反面</p>
                </li>
            </ul>
        </div>



    </div>


    <!--<div class="msg yingchan">-->
        <!--<p class="yz">验证手机号</p>-->
        <!--<div class="message">-->
            <!--<div class="clearfix item">-->
                <!--<input class="fl phone" type="number" placeholder="请输入手机号">-->
                <!--<button class="fl">发送验证码</button>-->
            <!--</div>-->
            <!--<div class="clearfix item">-->
                <!--<input class="fl code" type="number" placeholder="请输入验证码">-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->
    <div class="default">
        <p class="de">押金费用</p>
        <div class="choice clearfix">
            <div class="fy fl">
                <p>500元</p>
                <p>全程押金 500元/人，返程后7个工作日退还。</p>
            </div>
        </div>
        <p id="zf" class="zf">自费费用</p>
        <div class="choice clearfix">
            <div class="fy fl isfalg">
                <!--<p>200元</p>-->
                <!--<p class="shuoming">年龄在55周岁以下，非广东和香港籍，洋小秘用户</p>-->
            </div>
            <!--<div class="fy fl">-->
                <!--<p>300元</p>-->
                <!--<p class="shuoming">年龄在55至65周岁之间，非广东和香港籍，洋小秘用户</p>-->
            <!--</div>-->
            <!--<div class="fy fl">-->
                <!--<p>500元</p>-->
                <!--<p class="shuoming">广东和香港籍，洋小秘用户</p>-->
            <!--</div>-->
        </div>
    </div>
    <!-- 继续报名 -->
    <div class="Continue">
        <div class="con">
            <div class="total">总费用:{$order.order_pri}元</div>
            <button class="jxbm" >提交</button>
            <!--onclick="callpay()"-->
        </div>
    </div>
    <div class="mask"></div>

    <!-- 动画 -->
    <div id="dx">
        <div class="dx-box">
            <!-- <img class="del" src="__HOME_IMAGES__/inco_bianji_de@2x.png" alt=""> -->
            <img class="ddd" src="__HOME_IMAGES__/wh/dx.gif" alt="">
            <p>图片努力上传中...</p>
        </div>

    </div>
    <div class="model">请输入常用手机号</div>
</body>
<!--<script src="//cdn.jsdelivr.net/npm/eruda"></script>-->
<!--<script>-->
    <!--eruda.init();-->
<!--</script>-->



</html>
<script>
    var order_type='{$order.order_type}';
    var payfalg=true;
 $(function(){

     $('.del').on('click',function(){
         $('.tips').remove();
     })

     var zf=$("div.choice.clearfix div.fy.fl.isfalg");
     var str='';
     if(order_type==4){
         str+="<p>1000元</p>";
         str+="<p class=\"shuoming\">【香港大会收费标准，满足条件的全部叠加计算】<br>" +
             "①200元：澳门威尼斯人观演费用<br>" +
             "②300元：55~65周岁<br>" +
             "③500元：广东籍与香港籍<br>" +
             "④1500元：小于22周岁（不含）</p>";
     }else if(order_type==3){
             str+="<p>700元</p>";
             str+="<p class=\"shuoming\">【香港大会收费标准，满足条件的全部叠加计算】<br>" +
                 "①200元：澳门威尼斯人观演费用<br>" +
                 "②300元：55~65周岁<br>" +
                 "③500元：广东籍与香港籍<br>" +
                 "④1500元：小于22周岁（不含）</p>";
     }else if(order_type==2){
         str+="<p>500元</p>";
         str+="<p class=\"shuoming\">【香港大会收费标准，满足条件的全部叠加计算】<br>" +
             "①200元：澳门威尼斯人观演费用<br>" +
             "②300元：55~65周岁<br>" +
             "③500元：广东籍与香港籍<br>" +
             "④1500元：小于22周岁（不含）</p>";
     }else if(order_type==1){
         str+="<p>200元</p>";
         str+="<p class=\"shuoming\">【香港大会收费标准，满足条件的全部叠加计算】<br>" +
             "①200元：澳门威尼斯人观演费用<br>" +
             "②300元：55~65周岁<br>" +
             "③500元：广东籍与香港籍<br>" +
             "④1500元：小于22周岁（不含）</p>";
     }else if(order_type==5){
         str+="<p>2200元</p>";
         str+="<p class=\"shuoming\">【香港大会收费标准，满足条件的全部叠加计算】<br>" +
             "①200元：澳门威尼斯人观演费用<br>" +
             "②300元：55~65周岁<br>" +
             "③500元：广东籍与香港籍<br>" +
             "④1500元：小于22周岁（不含）</p>";
     }else if(order_type==6){
         str+="<p>1700元</p>";
         str+="<p class=\"shuoming\">【香港大会收费标准，满足条件的全部叠加计算】<br>" +
             "①200元：澳门威尼斯人观演费用<br>" +
             "②300元：55~65周岁<br>" +
             "③500元：广东籍与香港籍<br>" +
             "④1500元：小于22周岁（不含）</p>";
     }
     zf.html(str);
     })
    var user_phone='{$order.user_phone}';

    if('__HOME_IMAGES__/wh/icon_shenfenzheng@2x.png'!='{$order.user_qiimgurl_just}' &&'__HOME_IMAGES__/wh/icon_sfz@2x.png'!='{$order.user_qiimgurl_fan}'){
        payfalg=false;
        // $("div.yingchan.msg").hide();
    }
    var dataname='';
    var isfalg="";
    var pojodata={};

    // $(".up-data").on("click",function () {
    //     console.log(1111)
    // })
    // $("ul.up-box li").on("click",function () {
    //     var t=this;
    //     dataname =$(t).attr("data-name");
    //     isfalg =$(t).attr("isfalg");
    //     var inputobj= $(t).find("input[type=file]").click();
    //
    // })


    $("ul.up-box li input[type=file]").on("change",function () {
        var that = $(this);
        dataname =that.attr("data-name");
        isfalg =that.attr("isfalg");
        that.next().attr("src", "__HOME_IMAGES__/wh/timg2.gif").css("transform","scale(0.5)");
        var thisp=that.parent().next();
        var thispT=thisp.text();
        if(thispT=="拍摄正面" || thispT=="再次点击修改正面"){
            $("#dx p").text("签证正面努力上传中...");
        }else if(thispT=="拍摄反面" || thispT=="再次点击修改反面"){
            $("#dx p").text("签证反面努力上传中...");
        }

        var file = that[0].files[0];
        console.log(file)
        console.log(that[0])
        var render = new FileReader();
        render.readAsDataURL(file);


        render.onload = function(res){
            var imsrc = res.target.result;
            $.ajax({
                url:"/index.php?s=/Api/IndexApi/uploads_img",
                type:"post",
                data:{
                    unionid:'EkcIHDJhjog',
                    img:imsrc,
                    start_name:'sign'
                },
                beforeSend:function(){
                    $(".mask").show();
                    $("#dx").show();
                },
                success:function(res){
                    console.log(res);
                    var srcimg= res.AppendData
                    //alert(srcimg);
                    that.next().attr("src", srcimg);

                    if(thisp.text()=="拍摄正面"){

                        thisp.text("再次点击修改正面");
                    }else if(thisp.text()=="拍摄反面"){
                        thisp.text("再次点击修改反面");
                    }


                    pojodata[dataname]=srcimg;
                    $(".mask").hide();
                    $("#dx").hide();
                    console.log(pojodata);
                },
                error:function () {
                    $(".mask").hide();
                    $("#dx").hide();
                }
            })
        }
    })
    var countdown = 60;
    var code = 0;

    $("button.fl").on("click",function() {
        console.log(1)
        var obj = $("button.fl");
        var phone = $("input[type=number].phone").val();
        if(phone == "") {
            $(".model").fadeIn();
            setTimeout(function() {
                $('.model').fadeOut();
            }, 1000);
            return false;
        } else {
            $(".model").fadeOut();
        };
        console.log(phone);

                    $.ajax({
                        type: "post",
                        url: '/index.php?s=/Api/IndexApi/send_phone_code', //后台处理程序
                        dataType: 'json', //接受数据格式
                        data: {
                            unionid: 'EkcIHDJhjog',
                            phone: phone,
                            type: 6,
                        },
                        //要传递的数据
                        success: function(res) {
                            if(res.ResultType == 0) {
                                $(".model").html("获取成功");
                                $(".model").show();
                                setTimeout(function() {
                                    $('.model').fadeOut();
                                }, 1500);
                                code = res.AppendData
                            } else {
                                $(".model").html("获取失败");
                                $(".model").show();
                                setTimeout(function() {
                                    $('.model').fadeOut();
                                }, 1500);
                            }

                        },
                        error: function() {
                            alert("服务器繁忙，请稍后再试！");
                        }
                    });
                 settime(obj);



    });

    function settime(obj) { //发送验证码倒计时

        if(countdown == 0) {
            obj.attr('disabled', false);
            obj.text("点击获取");
            countdown = 60;
            return;
        } else {
            obj.attr('disabled', true);
            if(countdown < 10) {
                obj.text("0" + countdown + "S");
            } else {
                obj.text(countdown + "S");
            }
            countdown--;
        }
        setTimeout(function() {
            settime(obj)
        }, 1000)
    }

    $("button.jxbm").click(function() {
        // var phone = $("input[type=number].phone").val();
        // var num = $("input[type=number].code").val();
       // callpay();
        if(!payfalg){
            callpay();
            return;
        }
        if(pojodata.user_qiimgurl_just==null || pojodata.user_qiimgurl_just==''||pojodata.user_qiimgurl_fan==null || pojodata.user_qiimgurl_fan==''){

            if(confirm("签证照片未上传,请务必要记得12月9日到达深圳集合的时候要带好有效的港澳通行证，因为个人原因而无法出境，费用一律不予退还！")){
                callpay();
                return;
            }else{
                return
            }
            // $(".model").html("签证照片未上传");
            // $(".model").fadeIn();
            // setTimeout(function() {
            //     $('.model').fadeOut();
            // }, 1500);
            // return false;
        }
        // if(phone == "") {
        //     $(".model").fadeIn();
        //     setTimeout(function() {
        //         $('.model').fadeOut();
        //     }, 1500);
        //     return false;
        // } else {
        //     $(".model").fadeOut();
        // }
        //
        // if(num == "") {
        //     $(".model").html("请输入验证码")
        //     $(".model").fadeIn();
        //     setTimeout(function() {
        //         $('.model').fadeOut();
        //     }, 1500);
        //     return false;
        // } else {
        //     $(".model").fadeOut();
        // }
        // if(num != code) {
        //     $(".model").html("验证码错误")
        //     $(".model").fadeIn();
        //     //$(".hint").show()
        //     return false;
        // } else {
        //     $(".model").fadeOut();
        //     //$(".hint").hide()
        // }
       // pojodata["user_phone"]=phone;
        pojodata["uuid"]='{$uuid}';
        console.log(pojodata);

        $.ajax({
            type: "post",
            url: "/index.php?s=/Api/HK/hk_user_two", //后台处理程序
            dataType: 'json',
            data: pojodata, //要传递的数据
            success: function(res) {
                console.log(res)
                if(res.ResultType==0){
                    $(".model").html("提交成功")
                    $(".model").fadeIn();
                    setTimeout(function() {
                        $('.model').fadeOut();
                        callpay();
                        payfalg=false;
                    }, 1000);

                }

            },
            error: function() {
                alert("服务器繁忙，请稍后再试！");
            }
        })








})
</script>
<script type="text/javascript">
    function jsApiCall() {
        WeixinJSBridge.invoke('getBrandWCPayRequest', {$pay_info.pra},
        function (res) {
            WeixinJSBridge.log(res.err_msg);
            if (res.err_msg == 'get_brand_wcpay_request:ok') {
                // alert()
               window.location.href = "/index.php?s=/Home/Gosign/signsuccess.html&uuid={$uuid}";
             //   $.cookie('type','2', { expires: 7 });
            } else if (res.err_msg == "get_brand_wcpay_requeset:cance") {
                alert("您已经支付成功");
            }
        }
    );
    }



    function callpay() {
        jsApiCall();
    }
</script>
<script src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js" type="text/javascript"></script>
<script type="text/javascript">
    document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
        // 通过下面这个API隐藏右上角按钮hideOptionMenu
        WeixinJSBridge.call('hideOptionMenu');
    });
</script>