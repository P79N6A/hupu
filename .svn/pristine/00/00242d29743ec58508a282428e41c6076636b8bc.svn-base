<extend name="./base" />
<block name="css_extend">

    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
        <script src="__HOME_JS__/rem.js"></script>
        <link rel="stylesheet" href="__HOME_CSS__/rjl/Fullpreview.css">
        <script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
        <title>添加活动</title>
        <style>
            .clearfix::after {
                content: ".";
                clear: both;
                display: block;
                overflow: hidden;
                font-size: 0;
                height: 0;
            }

            .fl {
                float: left;
            }

            .content_box {
                width: 100%;
                background: #fff;
                padding-bottom: 15px;

            }

            .content_box .box {
                height: 50px;
                width: 95%;
                margin: 0 auto;
                background: #faf9f9;
                border: 1px solid #979797;
                margin-bottom: .25rem;
            }

            .content_box .titles {
                width: 45%;
                height: 100%;
                font-size: 18px;
                text-align: center;
                line-height: 50px;
                font-weight: 100;
                color: #ccc;
            }

            .content_box input {
                width: 45%;
                height: 85%;
                padding-top: 1rem;
                background: #faf9f9;
                color: #ccc;
            }

            .seccond {
                padding-bottom: 0.5rem;
            }

            .tiact {
                width: 100%;
                height: auto;
                background: #fff;
                position: relative;
                margin: 0.2rem 0;
            }

            .jump_link {
                width: 100%;
                height: 60px;
                background: #32CEA0;
                position: fixed;
                bottom: 0;
                left: 0;
            }

            .jump_link a {
                display: block;
                width: 100%;
                height: 100%;
                line-height: 60px;
                color: #fff;
                font-size: 0.8rem;
                text-align: center;
            }

            .check {
                width: 100%;
                height: 60px;
                background: #32CEA0;
                position: fixed;
                bottom: 0;
                left: 0;
            }

            .check a {
                display: block;
                width: 100%;
                height: 100%;
                line-height: 60px;
                color: #fff;
                font-size: 0.8rem;
                text-align: center;
            }



            .tips {
                width: 100%;
                height: 100%;
                position: fixed;
                left: 0;
                z-index: 999;
                top: 0;
                background: rgba(0, 0, 0, .6);
                display: none;
            }

            .tips .content {
                width: 100%;
                height: 100%;
                position: relative;
                color: #fff;
            }

            .content .Arrow {
                display: block;
                position: absolute;
                top: .5rem;
                right: .8rem;
                width: 4.8rem;
                height: 2.8rem;
            }

            .content p {
                color: #fff;
            }

            .content .tip_one {
                position: absolute;
                width: 16rem;
                font-size: 1rem;
                top: 12%;
                left: 55%;
                margin-left: -8rem;

            }

            .content .tips_two {
                position: absolute;
                width: 18rem;
                height: 3rem;
                line-height: 3rem;
                font-size: 1rem;
                top: 20%;
                left: 55%;
                margin-left: -8rem;
            }

            .content .tips_two img {
                width: 2.5rem;
                height: 2.5rem;
            }

            .content .tips_two .fl+.fl {
                margin-left: 10px;
            }

            .content .tips_three {
                position: absolute;
                width: 18rem;
                height: 3rem;
                line-height: 3rem;
                font-size: 1rem;
                top: 32%;
                left: 55%;
                margin-left: -8rem;
            }

            .tips_three img {
                width: 2.5rem;
                height: 2.5rem;
            }

            .tips_three .fl+.fl {
                margin-left: 10px;
            }

            .konw {
                width: 8rem;
                height: 2.5rem;
                line-height: 2.5rem;
                text-align: center;
                border: 2px solid #fff;
                border-radius: 2rem;
                position: absolute;
                top: 50%;
                left: 50%;
                margin-left: -4rem;
                margin-top: -1.5rem;
                font-size: 0.8rem;
            }

            .share_text {
                width: 4.5rem;
                height: 1.8rem;
                line-height: 1.8rem;
                background: rgba(0, 0, 0, .6);
                position: fixed;
                z-index: 999;
                top: 1rem;
                right: 0.5rem;
                text-align: center;
                color: #fff;
                border-radius: 2rem;
            }

            .share_text .box_ {
                width: 100%;
                height: 100%;
                position: relative;
            }

            .share_text img {
                width: 1rem;
                height: 1rem;
                position: absolute;
                top: 50%;
                left: 15%;
                margin-top: -0.5rem;
            }

            .share_text p {
                height: 1rem;
                line-height: 1rem;
                color: #fff;
                position: absolute;
                top: 50%;
                margin-top: -0.5rem;
                right: 20%;
            }
        </style>
    </head>
</block>
<block name="body">

    <body>
        <div class="conrjl">
            <div class="conter">
                <div class="ylfst">
                    <div class="yltp">

                    </div>
                </div>
                <div class="tiact"></div>
            </div>
            <div class="seccond">
                <div class="sec_tit">
                    报名表
                </div>
                <div class="content_box">

                </div>
            </div>

        </div>
        <div class="rjl_thir">
            <a href="/index.php?s=/Home/Activity/Coactivities.html">我也要参与</a>
        </div>

        <div class="share_text">
            <div class="box_">
                <img src="__HOME_IMAGES__/2x.share_msg.png" alt="">
                <p> 分享</p>
            </div>
        </div>

        <div class="tips">
            <div class="content">


                <img class="Arrow" src="__HOME_IMAGES__/inco_youshang@2x.png" alt="">
                <p class="tip_one">1.点击右上角</p>


                <div class="tips_two clearfix">
                    <div class="fl">2.点击</div>
                    <img class="fl" src="__HOME_IMAGES__/inco_fasong@2x.png" alt="">
                    <div class="fl">或者</div>
                    <img class="fl" src="__HOME_IMAGES__/2x-friend.png" alt="">
                    <div class="fl">分享</div>

                </div>


                <div class="tips_three clearfix">
                    <div class="fl">3.点击</div>
                    <img class="fl" src="__HOME_IMAGES__/inco_lianjie@2x.png" alt="">
                    <div class="fl">复制链接</div>
                </div>
                <div class="konw">我知道了</div>
            </div>
        </div>





        <if condition="$hidden eq 1">

            <else />
            <div class="jump_link">
                <a href="javascript:;">点击复制推广链接</a>
            </div>
        </if>


        <script>

            //点击分享
            $(".share_text").on("click", function () {
            $(this).hide();
            $(".tips").show();
            })

            //我知道了
            $(".konw").on("click", function () {
            $(".tips").hide();
            $(".share_text").show();
            });
            $('#videoForm').remove();
            $('#sendBefore').remove();
            $('.updata').remove();

            $(function () {

                var user_id = '{$unionid}';

                function GetQueryString(name) {
                    if (window.location.href.indexOf('?') > -1) {
                        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
                        var r = decodeURIComponent(window.location.href.substr(1).split('?')[1]).match(reg);
                        if (r != null) return unescape(r[2]);
                    }
                    return ''; //便于容错处理
                }


                var user_id = '{$unionid}';

                var getid = GetQueryString("share_user_id");

                var search = location.search;


                function getCaption(obj) {
                    var index = obj.lastIndexOf("/");
                    obj = obj.substring(index + 1, obj.length);
                    // console.log(obj);
                    return obj;
                }


                var detailid = getCaption(search);



                var id = '{$id}';


                if (id != 0) {
                    detailid = id;
                }




                $(".jump_link a").attr("href",
                    "/index.php?s=/Home/Sharingplatform/PerfectInformation&type=4&href=/Home/Share/my_Activity_detail/id/" +
                    detailid + "");
                $(".rjl_thir a").attr("href", "/index.php?s=/Home/Activity/Coactivities.html&id=" + detailid +
                    "");

                $.ajax({
                    type: 'post',
                    url: "index.php?s=/Api/SignUpApi/sign_detail",
                    data: {
                        unionid: user_id,
                        sign_id: detailid,
                    },
                    success: function (res) {
                        console.log(res)
                        var detail = res.AppendData.detail;
                        console.log(detail)
                        var list = '';
                        list += '<div class="ylfst">'
                        list += '<div class="yltp">'
                        list += '<img src="' + res.AppendData.cover_img + '" class="zhuq">'
                        list += '<div class="fstdan">'
                        list += '<img src="' + res.AppendData.headimg + '" class="quest">'
                        list += '</div>'
                        list += '</div>'
                        list += '<div class="yltit">'
                        list += '<div class="rjl_text">' + res.AppendData.title + '</div>'
                        list += '<div class="rjl_time">' + res.AppendData.addtime + '</div>'
                        list += '</div>'
                        list += '<span CLASS="fad">' + res.AppendData.nick_name + '</span>'
                        list += '<span class="cany">' + res.AppendData.join_count + '人参与</span>'
                        list += '<span class="chak">' + res.AppendData.look + '人查看</span>'
                        list += '</div>'
                        list += '<div class="tiact">'
                        list += '<div class="rjl_wz">'
                        list += '<span>' + res.AppendData.content + '</span>'
                        list += '</div>'
                        list += '</div>'

                        $(".conter").html(list);

                        $(".add_parameter").each(function (i, e) {
                            $(e).remove();
                        })

                        $(".ryc").each(function (i, e) {
                            if ($(e).attr("src") == '__HOME_IMAGES__/home_moren.png') {
                                $(e).remove();
                            }
                            $('.add_timg').remove();
                        })

                        $(".cookerl").remove();

                        var baoming = '';
                        $.each(detail, function (k, v) {
                            baoming += '<div class="box">'
                            baoming += '<div class="titles fl">' + v.title + '</div>'
                            baoming +=
                                '<input class="fl" type="text" disabled placeholder="点击下方即可参与">'
                            baoming += '</div>'
                        })
                        $(".content_box").html(baoming)

                    },
                    error: function () {
                        mui.alert("异常！")
                    },

                })
            });



            $('.conrjl').on('click', '.guan', function () {
                console.log(111)
                $('.chakxq').hide();
            })
        </script>




        <script>




            $(function() {
                var share_url = "{$share_url}";

                $.ajax({
                    //几个参数需要注意一下
                    type: "POST", //方法类型
                    dataType: "json", //预期服务器返回的数据类型
                    url: "index.php?s=/Api/WeShare/getSignPackage", //url
                    data:{share_url:share_url},
                    async: true,

                    // async: false,
                    success: function(result) {



                        wx.config({
                            debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。移动端会通过弹窗来提示相关信息。如果分享信息配置不正确的话，可以开了看对应报错信息
                            appId: result.AppendData.appId,
                            timestamp: result.AppendData.timestamp,
                            nonceStr: result.AppendData.nonceStr,
                            signature: result.AppendData.signature,
                            jsApiList: [ //需要使用的JS接口列表,分享默认这几个，如果有其他的功能比如图片上传之类的，需要添加对应api进来
                                'checkJsApi',
                                'onMenuShareTimeline', //
                                'onMenuShareAppMessage',
                                'onMenuShareQQ',
                                'onMenuShareWeibo',
                                'getLocation'
                            ]
                        });



                        wx.ready(function () {
                            //分享到朋友圈
                            wx.onMenuShareTimeline({
                                title: "{$sharetitle}", // 分享链接
                                desc: "{$desc}", // 分享链接
                                link: "{$link_url}", //分享出去后的链接，这里可以将链接设置为另一个页面。
                                imgUrl: "{$imgUrl}", // 分享链接
                                success: function () {
                                    // 用户确认分享后执行的回调函数
                                    sharePush();
                                },
                                cancel: function () {
                                    // 用户取消分享后执行的回调函数
                                }
                            });
                            //分享给朋友
                            wx.onMenuShareAppMessage({
                                title: "{$sharetitle}", // 分享链接
                                desc: "{$desc}", // 分享链接

                                link: "{$link_url}", //分享出去后的链接，这里可以将链接设置为另一个页面。
                                imgUrl: "{$imgUrl}", // 分享链接
                                type: '', // 分享类型,music、video或link，不填默认为link
                                dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
                                success: function () {
                                    // 用户确认分享后执行的回调函数
                                    sharePush();
                                },
                                cancel: function () {
                                    // 用户取消分享后执行的回调函数
                                }
                            });
                            //分享到QQ
                            wx.onMenuShareQQ({
                                title: "{$sharetitle}", // 分享链接
                                desc: "{$desc}", // 分享链接
                                link: "{$link_url}", //分享出去后的链接，这里可以将链接设置为另一个页面。
                                imgUrl: "{$imgUrl}", // 分享链接
                                success: function () {
                                    // 用户确认分享后执行的回调函数
                                    sharePush();
                                },
                                cancel: function () {
                                    // 用户取消分享后执行的回调函数
                                }
                            });
                            //分享到腾讯微博
                            wx.onMenuShareWeibo({
                                title: "{$sharetitle}", // 分享链接
                                desc: "{$desc}", // 分享链接
                                link: "{$link_url}", //分享出去后的链接，这里可以将链接设置为另一个页面。
                                imgUrl: "{$imgUrl}", // 分享链接
                                success: function () {
                                    // 用户确认分享后执行的回调函数
                                    sharePush();
                                },
                                cancel: function () {
                                    // 用户取消分享后执行的回调函数
                                }
                            });
                            //分享到QQ空间
                            wx.onMenuShareQZone({
                                title: "{$sharetitle}", // 分享链接
                                desc: "{$desc}", // 分享链接
                                link: "{$link_url}", //分享出去后的链接，这里可以将链接设置为另一个页面。
                                imgUrl: "{$imgUrl}", // 分享链接
                                success: function () {
                                    // 用户确认分享后执行的回调函数
                                    sharePush();
                                },
                                cancel: function () {
                                    // 用户取消分享后执行的回调函数
                                }
                            });

                        });

                    },
                    error: function() {
                        alert("服务器繁忙，请稍后再试！");
                    }
                });




            });










        </script>


    </body>
</block>