<?php/** 新V网首页*/namespace app\home\controller;use app\common\controller\HomeBase;use think\Db;class Vhome extends HomeBase{    /**     *新V网     */    public function card_jump()    {        $style = Db::table('s_user_info')->where(array('id'=>$this->userInfo['id']))->column('style');        if($style == 5){            header("location:".url("Home/Card/myCard/style/".$style));        }elseif($style == 6 || $style == 8 || $style == 10 || $style == 12 || $style == 14 || $style == 15 || $style == 16){            header("location:".url("Home/Card/newgreencard/style/".$style));        }elseif($style == 7|| $style == 9 || $style == 11 || $style == 13){            header("location:".url("Home/Vhome/index/style/".$style));        }    }    //新首页    public function index()    {        $this->title="V网首页";        $nick_name=$this->userInfo['nick_name'];        $share_my_introduct=$this->userInfo['share_my_introduct'];        $headimg=$this->userInfo['headimg'];        $protocol = (!empty($_SERVER['HTTPS']) && $_SERVER['HTTPS'] !== 'off' || $_SERVER['SERVER_PORT'] == 443) ? "https://" : "http://";        $url = "$protocol$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]";        $this->assign('share_url', $url);        $this->assign('sharetitle',  $nick_name);        $contents = cutstr_html( $share_my_introduct);        $contents =str_replace('"', '\'', $contents);        $this->assign('desc', preg_replace('/\s/is','', $contents));        if(substr( $headimg,0,4) == 'http'){            $imgUrl =  $headimg;        }else{            $imgUrl = 'http://'.$_SERVER['HTTP_HOST']. $headimg;        }        $this->assign('share_host', config('SHARE_HOST'));        $this->assign('imgUrl', $imgUrl);        $this->style = Input('get.style');        return  $this->fetch();    }        //内容详情    public function showdetail()    {        $this->title="V网首页";        return  $this->fetch();    }    	//排序	public function sorts()	{    	$this->style = Input('get.style');        return  $this->fetch();    }	    //添加图文	public function addgraphic()	{    	$this->type_id = Input('get.type_id');		$this->show_id = Input('get.show_id');		$this->title = Input('get.title');        return  $this->fetch();    }	    //我的金融资源	public function myres()	{    	$this->type_id = Input('get.type_id');    	$this->show_id = Input('get.show_id');    	$this->title = Input('get.title');        return  $this->fetch();    }	    //添加图文	public function addimgtxt()	{		$this->show_id = Input('get.show_id');		$this->type_id = Input('get.type_id');		$this->title = Input('get.title');        return  $this->fetch();    }        //添加图文(使用与app)    public function addimgtxt_app()    {        $this->unionid = Input('get.unionid');//unionid        $this->show_id = Input('get.show_id');//图文id        $this->type_id = Input('get.type_id');//自定义栏目id        $this->title = Input('get.title');//标题        return  $this->fetch('Vhome/addimgtxt');    }        //添加图文预览	public function preview()	{    	$this->type_id = Input('get.type_id');    	$this->show_id = Input('get.show_id');    	$this->title = Input('get.title');        return  $this->fetch();    }        //音乐设置    public function mymusic()    {        return  $this->fetch();    }        //其他设置    public function other()    {        return  $this->fetch();    }    //图标    public function icon()    {        return  $this->fetch();    }        //添加内容展示栏目    public function vlinkage()    {        return  $this->fetch();    }        //内容展示栏目拖动排序    public function compositor()    {        return  $this->fetch();    }        //添加产品    public function addproduct()    {    	$this->type_id = Input('get.typeid');//分类id    	$this->p_id = Input('get.id');//产品id    	$this->title = Input('get.title');        return  $this->fetch();    }        //产品预览    public function propreview()    {    	$this->unionid= Input('get.unionid');//用户唯一标识    	$this->type_id = Input('get.typeid');//分类id    	$this->p_id = Input('get.p_id');//产品id        // 注意 URL 一定要动态获取，不能 hardcode.        $protocol = (!empty($_SERVER['HTTPS']) && $_SERVER['HTTPS'] !== 'off' || $_SERVER['SERVER_PORT'] == 443) ? "https://" : "http://";        $url = "$protocol$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]";        $this->assign('share_url', $url);        $link_url = 'http://'.$_SERVER['HTTP_HOST'].'/index.php?s=/Home/vhome/propreview/p_id/'.Input('get.p_id').'/type_id/'. Input('get.typeid').'/unionid/'.Input('get.unionid');        $data = Db::table('s_product')->field('title,describe,cover_img')->where(array('id'=>Input('get.p_id')))->find();        $content = mb_substr(cutstr_html($data['describe']),0,20,'utf-8').'...';        $content = str_replace(PHP_EOL, ' ', str_replace('"','',$content));        $this->assign('title', $data['title']);        $this->assign('desc',$content);        $this->assign('link', $link_url);        $this->assign('imgUrl', $data['cover_img']);        return  $this->fetch();    }        //移动    public function move()    {        return  $this->fetch();    }}